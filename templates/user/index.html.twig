{% extends 'base.html.twig' %}

{% block title %}My Notes - Mentionable{% endblock %}

{% block body %}
    <div class="main-panel">
        <div class="content-wrapper p-0">
            <div class="row justify-content-center mb-4 pt-4">
                <div class="col-lg-8 p-3 justify-content-center">
                    <div class="d-flex flex-row justify-content-center">
                        <h1 class="text-center">
                            My notes
                        </h1>
                        <span class="badge badge-light text-dark mt-2 ms-3" style="height: 25px">{{ notesCount }}</span>
                    </div>
                </div>
                {# ERROR MESSAGE #}
                <div class="col-lg-7 m-0 p-0 mb-3" id="errorWhilePosting" style="display: {{ divVisibility|default('none') }};">
                    <span class="badge bg-danger">{{ error|default('') }}</span>
                </div>
                {# NOTES LIST #}
                <div class="row justify-content-center mb-4">
                    {# NOTE #}
                    {% if notes is defined %}
                        <div id="notes-container" class="d-flex flex-column align-items-center">
                            {% include 'default/_note.html.twig' with {
                                notes: notes,
                                votesMap: votesMap,
                                commentVotesMap: commentVotesMap,
                                favoritesMap: favoritesMap,
                                rolesMap: rolesMap,
                                limitedComments: limitedComments,
                                currentUserNametag: currentUserNametag
                            } %}
                        </div>
                    {% else %}
                        <div class="col-lg-7 pt-4 ps-4 pe-4" style="background-color: #181b20; border-radius: 5px; margin-top: 2rem;">
                            <p class="text-light">Oops. No notes available here.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
{{ parent() }}
<script>
    window.votesMap = {{ votesMap|json_encode|raw }};
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const buttons = document.querySelectorAll(".toggle-comments");

    buttons.forEach(button => {
        button.addEventListener("click", function () {
            const noteId = this.getAttribute("data-note-id");
            const commentSection = document.getElementById("comments-" + noteId);

            if (commentSection) {
                if (commentSection.style.display === "none" || commentSection.style.display === "") {
                    commentSection.style.display = "block";
                } else {
                    commentSection.style.display = "none";
                }
            } else {
                console.error("Nu s-a gÄƒsit elementul pentru comentarii cu id: comments-" + noteId);
            }
        });
    });
});
</script>
<script src="{{ asset('../assets/js/emoji.js') }}"></script>
{% endblock %}