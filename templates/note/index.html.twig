{% extends 'base.html.twig' %}

{% block title %}Note - Mentionable{% endblock %}

{% block body %}
<div class="main-panel">
        <div class="content-wrapper p-0">
            <div class="row justify-content-center mb-4">
                    {# NOTE #}
                    {% if note is defined %}
                        <div id="notes-container" class="d-flex flex-column align-items-center">
                            {% include 'note/_note_partial.html.twig' with {
                                note: note,
                                votesMap: votesMap,
                                commentVotesMap: commentVotesMap,
                                favoritesMap: favoritesMap,
                                rolesMap: rolesMap,
                                currentUserNametag: currentUserNametag
                            } only  %}
                        </div>
                    {% else %}
                        <div class="col-lg-7 pt-4 ps-4 pe-4" style="background-color: #181b20; border-radius: 5px; margin-top: 2rem;">
                            <p class="text-light">Oops. No notes available here.</p>
                        </div>
                    {% endif %}
                </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
{{ parent() }}
<script>
    window.votesMap = {{ votesMap|json_encode|raw }};
</script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const buttons = document.querySelectorAll(".toggle-comments");

        buttons.forEach(button => {
            button.addEventListener("click", function () {
                const noteId = this.getAttribute("data-note-id");
                const commentSection = document.getElementById("comments-" + noteId);

                if (commentSection) {
                    if (commentSection.style.display === "none" || commentSection.style.display === "") {
                        commentSection.style.display = "block";
                    } else {
                        commentSection.style.display = "none";
                    }
                } else {
                    console.error("Nu s-a gÄƒsit elementul pentru comentarii cu id: comments-" + noteId);
                }
            });
        });
    });
</script>
<script src="{{ asset('../assets/js/feed.js') }}"></script>
{% endblock %}
